!function(){window.localStorage.getItem("id");Vue.http.interceptors.push(function(t,s){t.credentials=!0,s()});new Vue({el:"body",data:{timer:null,domain:"http://www.yinzishao.cn:8000/",status:{isParent:!0,isNoParent:!1,isLoading:!1,myInfo:!1,isTutorInfo:!1,isDefault:"",isSuccess:"",getLocation:!1,expection:!1,isSubmit:!1,isInfoTipOne:!1,errorTip:"对不起，您还未通过审核"},msgList:[],detailedList:[],para:{size:9,start:0},jsonData:[],form:{selected:"",isRegister:"",expection:""},location:{latitude:"",longitude:"",speed:"",accuracy:""},signature:""},ready:function(){this.getData(),this.status.isLoading=!0},methods:{down:function(){this.para.size=5,this.para.start++,console.log(this.jsonData),0!==this.jsonData.length&&this.getData()},getData:function(){var t=this;this.$http.post(this.domain+"getParentOrder",this.para,{crossOrigin:!0,headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(s){if(console.log(s.json()),0==s.json().success)console.log(s.json().error);else{this.jsonData=s.json();var i=s.json();if(0!=i.length){for(var e=0;e<i.length;e++){var o=this.grade_level(i[e].class_field);i[e].class_field=o}var n=t.msgList.concat(i);this.$set("msgList",n)}else 0==this.msgList.length&&(this.status.isParent=!1,this.status.isNoParent=!0)}})},grade_level:function(t){switch(t){case 0:return"";case 1:return"较为靠后";case 2:return"中等偏下";case 3:return"中等水平";case 4:return"中上水平";case 5:return"名列前茅"}},configuration:function(){var t=this;wx.config({debug:!0,appId:"wx6fe7f0568b75d925",timestamp:1482652615,nonceStr:"yinzishao",signature:t.signature,jsApiList:["getLocation"]})},getSignature:function(){this.$http.post(this.domain+"",{timestamp:1482652615,nonceStr:"yinzishao"},{emulateJSON:!0,crossOrigin:!0,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){this.signature=t.json().signature})},wxReady:function(){var t=this;wx.ready(function(){wx.getLocation({type:"wgs84",success:function(s){t.form.latitude=s.latitude,t.form.longitude=s.longitude,t.form.speed=s.speed,t.form.accuracy=s.accuracy,console.log("latitude : "+t.form.latitude+"--longitude : "+t.form.longitude+"--speed : "+t.form.speed+"--accuracy : "+t.form.accuracy)}})})},setLocation:function(){this.status.getLocation=!0,this.getSignature(),this.configuration(),this.wxReady()},onAllow:function(){this.$http.post(this.domain+"",this.location,{emulateJSON:!0,crossOrigin:!0,headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(t){1==t.json().result&&(this.status.getLocation=!1)})},onCancel:function(){this.status.getLocation=!1},onRecommend:function(){this.status.tutorList=!0,this.status.myInfo=!1},onMine:function(){window.location.href="./teacherMyPage.html"},onTutorInfo:function(t){this.form.selected=t,this.status.isTutorInfo=!0,this.detailedList=this.msgList[t],"已报名"==this.msgList[t].isInvited?(this.status.isDefault=!0,this.status.isSuccess=!1,this.form.isRegister="取消报名"):"已拒绝"==this.msgList[t].isInvited?(this.status.isDefault=!0,this.status.isSuccess=!1,this.form.isRegister="报名被拒绝"):"已接受"==this.msgList[t].isInvited?(this.status.isDefault=!1,this.status.isSuccess=!0,this.form.isRegister="报名已接受"):"已完成"==this.msgList[t].isInvited?(this.status.isDefault=!1,this.status.isSuccess=!0,this.form.isRegister="双方已成交"):(this.status.isDefault=!1,this.status.isSuccess=!0,this.form.isRegister="报名")},onClose:function(){this.status.isTutorInfo=!1},onRegister:function(t){if("取消报名"==this.form.isRegister)this.$http.post(this.domain+"applyParent",{pd_id:this.msgList[t].pd_id,type:0},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(console.log(s.json()),1==s.json().success){this.form.isRegister="取消成功";var i=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.msgList[t].isInvited="",i.status.isTutorInfo=!1},1e3)}else conosle.log(s.json().error)});else{if("报名"!=this.form.isRegister)return!1;this.status.isTutorInfo=!1,this.status.expection=!0}},onApply:function(t){this.$http.post(this.domain+"applyParent",{pd_id:this.msgList[t].pd_id,expectation:this.form.expection,type:1},{emulateJSON:!0,crossOrigin:!0,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(s){console.log(s.json());var i=this;1==s.json().success?(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.msgList[t].isInvited="已报名",i.status.expection=!1,i.form.expection=""},1e3)):(console.log(s.json().error),this.status.errorTip=s.json().error,this.status.isTutorInfo=!1,this.status.isInfoTipOne=!0,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isInfoTipOne=!1},2e3))})},onCloseExp:function(){this.status.expection=!1}}})}();