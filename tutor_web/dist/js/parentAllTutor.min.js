!function(){Vue.http.interceptors.push(function(t,s){t.credentials=!0,s()});new Vue({el:"body",data:{timer:null,domain:"http://www.yinzishao.cn",status:{isTutorInfo:!1,isSuccess:"",isDefault:"",isInfoTipOne:!1,selected:"",isRegister:"",isLoading:!1,errorTip:"对不起，您只能选择一位老师",isTutor:!0,isNoTutor:!1,isBanner:!1,isEnlargeImg:!1,enlargeImg:""},recommendList:[],detailedList:[],formGroup:[{value:[{tag:"科目"},{tag:"数学"},{tag:"语文"},{tag:"英语"},{tag:"物理"},{tag:"化学"},{tag:"生物"},{tag:"奥数"},{tag:"音乐"},{tag:"美术"},{tag:"全科"},{tag:"其他"}]},{value:[{tag:"年级"},{tag:"小学1年级"},{tag:"小学2年级"},{tag:"小学3年级"},{tag:"小学4年级"},{tag:"小学5年级"},{tag:"小学6年级"},{tag:"初中1年级"},{tag:"初中2年级"},{tag:"初中3年级"},{tag:"高中1年级"},{tag:"高中2年级"},{tag:"高中3年级"}]},{value:[{tag:"年级"},{tag:"大学辅导"},{tag:"成人辅导"}]},{value:[{tag:"最热门",key:1},{tag:"最新",key:2}]}],grade:[{tag:"年级"},{tag:"小学1年级"},{tag:"小学2年级"},{tag:"小学3年级"},{tag:"小学4年级"},{tag:"小学5年级"},{tag:"小学6年级"},{tag:"初中1年级"},{tag:"初中2年级"},{tag:"初中3年级"},{tag:"高中1年级"},{tag:"高中2年级"},{tag:"高中3年级"}],swipeinfo:[],mySwipe:{},slideNum:{},jsonData:[],change:{subject:"科目",grade:"年级"},form:{size:6,start:0,subject:"",grade:"",hot:1}},watch:{"change.subject":function(){this.onSelect()}},ready:function(){this.getImg(),this.renderData()},methods:{getImg:function(){this.$http.post(this.domain+"/getText",{key:["getImg"]},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),1==t.json().success){var s=t.json().getImg;if(s.length>0){for(var e=0;e<s.length;e++){var i=s[e].img;s[e].img=this.domain+i,""!=s[e].url&&null!=s[e].url||(s[e].url="#")}this.$set("swipeinfo",s),this.$nextTick(function(){this.getSwipe()})}else this.status.isBanner=!0}else console.log(t.json().error)})},down:function(){this.form.start++,0!==this.jsonData.length&&this.renderData()},getSwipe:function(){console.log(this.swipeinfo);var t=this,s=t.$els.swipe.getElementsByClassName("swipe-pagination-switch");t.mySwipe=new Swipe(t.$els.swipe,{startSlide:0,continuous:!0,speed:1e3,auto:1e3,stopPropagation:!1,callback:function(t,e){for(var i=0;i<s.length;i++)i!=t?(s[i].style.opacity="0.2",s[i].style.background="#333"):(s[t].style.opacity="1",s[t].style.background="#fff")}}),t.slideNum=t.mySwipe.getNumSlides()-1},slideToCur:function(t){var s=this;s.mySwipe.slide(t,300)},renderData:function(){this.$http.post(this.domain+"/getTeachers",this.form,{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),0==t.json().success)console.log(t.json().error);else{this.jsonData=t.json();var s=t.json();if(0!=s.length){this.status.isNoTutor=!1,this.status.isTutor=!0;for(var e=0;e<s.length;e++){""!=s[e].certificate_photo?s[e].certificate_photo=this.domain+s[e].certificate_photo:s[e].certificate_photo="../img/user02.png",0!==s[e].distance&&(s[e].distance=s[e].distance.toFixed(2));var i=s[e].teach_show_photo,a=s[e].teach_show_photo.length;if(0!=a)for(var o=0;o<a;o++)i[o]=this.domain+i[o];"您已拒绝"==s[e].isInvited||"老师已拒绝"==s[e].isInvited?s[e].isRed=!0:s[e].isRed=!1}var n=this.recommendList.concat(s);this.$set("recommendList",n)}else 0==this.recommendList.length&&(this.status.isNoTutor=!0,this.status.isTutor=!1)}})},onRecommend:function(){window.location.href="./parentPage.html"},onMine:function(){window.location.href="./parentMyPage.html"},onAllTutor:function(){this.status.isTutorInfo=!1},onTutorInfo:function(t){switch(this.status.isTutorInfo=!0,this.status.selected=t,this.status.isDefault=!1,this.status.isSuccess=!0,this.detailedList=this.recommendList[t],this.detailedList.isInvited){case"您已邀请":this.status.isDefault=!0,this.status.isSuccess=!1,this.status.isRegister="取消邀请";break;case"向您报名":this.status.isRegister="该老师已报名";break;case"您已拒绝":this.status.isDefault=!0,this.status.isSuccess=!1,this.status.isRegister="您已拒绝该老师";break;case"老师已拒绝":this.status.isDefault=!0,this.status.isSuccess=!1,this.status.isRegister="该老师已拒绝";break;case"您已同意":this.status.isRegister="您已接受该老师";break;case"管理员审核中":this.status.isRegister="管理员审核中";break;case"已成交":this.status.isRegister="双方已成交";break;case"":this.status.isRegister="邀请老师"}},onRegister1:function(t){var s,e,i;if("邀请老师"==this.status.isRegister)s=1,e="您已邀请",i="邀请成功";else{if("取消邀请"!=this.status.isRegister)return this.status.isTutorInfo=!1,!1;s=0,e="",i="取消成功"}this.$http.post(this.domain+"/inviteTeacher",{tea_id:this.recommendList[t].tea_id,type:s},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(console.log(s.json()),1==s.json().success){this.status.isRegister=i;var a=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){a.recommendList[t].isInvited=e,a.status.isTutorInfo=!1},1500)}else{console.log(s.json().error);var a=this;this.status.errorTip=s.json().error,this.status.isTutorInfo=!1,this.status.isInfoTipOne=!0,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){a.status.isInfoTipOne=!1},2e3)}})},onClose:function(){this.status.isTutorInfo=!1},onSelect:function(){"其他"==this.change.subject?(this.grade=this.formGroup[2].value,this.change.grade="年级",this.form.grade=""):(this.grade=this.formGroup[1].value,this.change.grade="年级",this.form.grade=""),"科目"!==this.change.subject?this.form.subject=this.change.subject:this.form.subject="",this.form.start=0,this.recommendList=[],this.renderData()},onSelectGrade:function(){"年级"!==this.change.grade?this.form.grade=this.change.grade:this.form.grade="",this.onSelectChange()},onSelectChange:function(){this.form.start=0,this.recommendList=[],this.renderData()},showImg:function(t){this.status.enlargeImg=this.detailedList.teach_show_photo[t],this.status.isEnlargeImg=!0},closeImg:function(){this.status.isEnlargeImg=!1}}})}();