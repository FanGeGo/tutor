function dateCompare(t,e){return t.day&&e.day?t.year>e.year||t.year==e.year&&t.month>e.month||t.year==e.year&&t.month==e.month&&t.day>=e.day:t.year>e.year||t.year==e.year&&t.month>e.month}!function(){Vue.http.interceptors.push(function(t,e){t.credentials=!0,e()});new Vue({el:"body",data:{domain:"http://shaozi.beansonbar.cn/",timer:null,calendar:{year:0,month:0,day:0,days:[],today:[],currentMonth:Number,monthString:"",weeks:["日","一","二","三","四","五","六"],months:["01","02","03","04","05","06","07","08","09","10","11","12"],show:!1,type:"date",value:"",sep:"-"},status:{tipQuestion:!0,Q1:!0,Q2:!1,Q3:!1,Q4:!1,Q5:!1,Q6:!1,Q7:!1,Q8:!1,isSelected:!0,isAllowanceTip:!1,isPrice:!1,isSubmit:!1,textTip:"",isLoading:!1,isOtherTutorChar:!1,textUsername:"",textAddress:"",getTip:!1,errorTip:""},learning_phase:[{value:[{tag:"小学",key:2},{tag:"初中",key:3},{tag:"高中",key:4},{tag:"幼升小",key:1},{tag:"其他",key:0}]},{value:["一年级","二年级","三年级","四年级","五年级","六年级"]},{value:["一年级","二年级","三年级"]},{value:[{tag:"名列前茅",key:5},{tag:"中上水平",key:4},{tag:"中等水平",key:3},{tag:"中等偏下",key:2},{tag:"较为靠后",key:1}]}],question:[{key:"Q1"},{key:"Q2"},{key:"Q3"},{key:"Q4"},{key:"Q5"},{key:"Q6"},{key:"Q7"},{key:"Q8"}],formGroup:[{value:[{tag:"数学"},{tag:"英语"},{tag:"语文"},{tag:"物理"},{tag:"化学"},{tag:"生物"},{tag:"奥数"},{tag:"音乐"},{tag:"美术"},{tag:"全科"}]},{value:[{tag:"升学考"},{tag:"择校"},{tag:"打基础"},{tag:"拔高"},{tag:"提高学习兴趣和方法",key:!0},{tag:"陪读"},{tag:"其他"}]},{value:[{key:"Mon",tag:"周一",begin:"mon_begin",end:"mon_end"},{key:"Tue",tag:"周二",begin:"tues_begin",end:"tues_end"},{key:"Wed",tag:"周三",begin:"wed_begin",end:"wed_end"},{key:"Thr",tag:"周四",begin:"thur_begin",end:"thur_end"},{key:"Fri",tag:"周五",begin:"fri_begin",end:"fri_end"}]},{value:{Sat:{tag:"周六",key:[{tag:"sat_morning"},{tag:"sat_afternoon"},{tag:"sat_evening"}]},Sun:{tag:"周日",key:[{tag:"sun_morning"},{tag:"sun_afternoon"},{tag:"sun_evening"}]}}},{value:{sex:{model:"teacher_sex",tag:"老师性别",key:[{key:"不限",num:0},{key:"男老师",num:1},{key:"女老师",num:2}]},char:{model:"teacher_method_arr",tag:"教学特点",key:["严厉要求","氛围轻松","亲和力强","其他"]}}}],salary:"",grade:["一年级","二年级","三年级","四年级","五年级","六年级"],Arr:{subjectArr:[],teacher_method_arr:[],aimArr:[],allowance:""},form:{subject:"",subject_other:"",aim:"",teacher_sex:0,teacher_method:"",teacher_method_other:"",learning_phase:2,class_field:0,grade:"一年级",require:"",salary:Number,allowance_not:0,bonus:"",name:"",tel:"",address:"",deadline:"",weekend_tutor_length:2,mon_begin:"",mon_end:"",tues_begin:"",tues_end:"",wed_begin:"",wed_end:"",thur_begin:"",thur_end:"",fri_begin:"",fri_end:"",sat_morning:0,sat_afternoon:0,sat_evening:0,sun_morning:0,sun_afternoon:0,sun_evening:0},time:{Mon:[],Tue:[],Wed:[],Thr:[],Fri:[]},location:{latitude:"",longitude:""},signature:""},created:function(){this.init();var t=this;window.setTimeout(function(){document.addEventListener("touchstart",function(e){e.stopPropagation(),t.cancel()},!1)},500)},computed:{grade_level:function(){switch(this.form.class_field){case 0:return"请选择";case 1:return"较为靠后";case 2:return"中等偏下";case 3:return"中等水平";case 4:return"中上水平";case 5:return"名列前茅"}},isBtnSuccess1:function(){return 0!==this.Arr.subjectArr.length||""!==this.form.subject_other&&null!=this.form.subject_other},isBtnSuccess2:function(){return 0!==this.Arr.aimArr.length},isBtnSuccess3:function(){return this.time.Mon.length>0||this.time.Tue.length>0||this.time.Wed.length>0||this.time.Thr.length>0||this.time.Fri.length>0||1==this.form.sun_morning||1==this.form.sun_afternoon||1==this.form.sun_evening||1==this.form.sat_morning||1==this.form.sat_afternoon||1==this.form.sat_evening},isBtnSuccess4:function(){return null!=this.form.teacher_sex||0!==this.Arr.teacher_method_arr.length},isBtnSuccess6:function(){return""!==this.form.require&&null!=this.form.require},isBtnSuccess7:function(){return this.form.salary!=Number&&null!=this.form.salary},isBtnSuccess8:function(){return""!==this.form.name&&""!==this.form.address&&""!==this.form.tel&&null!=this.form.name&&null!=this.form.address&&null!=this.form.tel},coachTime:function(){var t=this.form;return 1==t.sun_morning||1==t.sun_afternoon||1==t.sun_evening||1==t.sat_morning||1==t.sat_afternoon||1==t.sat_evening}},watch:{"form.learning_phase":function(){this.onSelect()},"Arr.allowance":function(t){1==t?(this.form.allowance_not=1,this.status.isAllowanceTip=!0):(this.form.allowance_not=0,this.status.isAllowanceTip=!1)},"calendar.value":function(t){this.form.deadline=t},"Arr.subjectArr":function(t){t.length>1?this.form.subject=t.join(","):this.form.subject=t[0]},"Arr.aimArr":function(t){t.length>1?this.form.aim=t.join(","):this.form.aim=t[0]},"Arr.teacher_method_arr":function(t){for(var e=0;e<this.Arr.teacher_method_arr.length;e++)"其他"==t[e]&&(this.status.isOtherTutorChar=!0);t.length>1?this.form.teacher_method=t.join(","):this.form.teacher_method=t[0]}},ready:function(){this.getData(),this.getParam()?(this.status.tipQuestion=!1,this.renderData()):this.status.tipQuestion=!0,this.status.isLoading=!0,this.getSignature()},methods:{getData:function(){this.$http.post(this.domain+"getText",{key:["salary"]},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){1==t.json().success?this.salary=t.json().salary:console.log(t.json().error)})},getParam:function(){var t=location.search;return t.indexOf("?")==-1?0:1},renderData:function(){this.$http.post(this.domain+"getParentInfo",{pd_id:"",format:""},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){console.log(t.json()),this.$set("form",t.json());var e=this.form.subject,n=this.form.aim,s=this.form.teacher_method,i=this.form.allowance_not,a=this.form.mon_end,r=this.form.tues_end,o=this.form.wed_end,h=this.form.thur_end,u=this.form.fri_end;null!==e&&""!==e&&this.getArr(e,"subjectArr"),null!==n&&""!==n&&this.getArr(n,"aimArr"),null!==s&&""!==s&&this.getArr(s,"teacher_method_arr"),1==i?this.Arr.allowance=!0:this.Arr.allowance=!1,null!==a&&""!==a&&this.getTimePeriod("mon_begin",a,"Mon"),null!==r&&""!==r&&this.getTimePeriod("tues_begin",r,"Tue"),null!==o&&""!==o&&this.getTimePeriod("wed_begin",o,"Wed"),null!==h&&""!==h&&this.getTimePeriod("thur_begin",h,"Thr"),null!==u&&""!==u&&this.getTimePeriod("fri_begin",u,"Fri")})},getArr:function(t,e){t.indexOf(",")==-1?this.Arr[e].push(t):this.Arr[e]=t.split(",")},getTimePeriod:function(t,e,n){for(var s=this.form[t];s<=e;s++)this.time[n].push(s)},getSignature:function(){this.$http.post(this.domain+"generate_signature",{timestamp:1482652615,nonceStr:"yinzishao"},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),1==t.json().success){this.signature=t.json().signature;var e=this;wx.config({debug:!1,appId:"wx7a327445ac3309b4",timestamp:1482652615,nonceStr:"yinzishao",signature:e.signature,jsApiList:["getLocation","openLocation"]})}else console.log(t.json().error)})},zero:function(t){return t<10?"0"+t:t},init:function(){var t=new Date;if(""!=this.calendar.value){this.calendar.value.indexOf("-")!=-1&&(this.calendar.sep="-"),this.calendar.value.indexOf(".")!=-1&&(this.calendar.sep="."),this.calendar.value.indexOf("/")!=-1&&(this.calendar.sep="/");var e=this.calendar.value.split(this.calendar.sep);this.calendar.year=parseInt(e[0]),this.calendar.month=parseInt(e[1])-1,this.calendar.day=parseInt(e[2])}else""==this.calendar.sep&&(this.calendar.sep="/"),this.calendar.year=t.getFullYear(),this.calendar.month=t.getMonth(),this.calendar.day=t.getDate();this.calendar.monthString=this.calendar.months[this.calendar.month],this.render(this.calendar.year,this.calendar.month)},render:function(t,e){var n=new Date(t,e,1).getDay(),s=new Date(t,e+1,0).getDate(),i=new Date(t,e,0).getDate();this.calendar.year=t,this.calendar.currentMonth=this.calendar.months[e];var a,r=this.calendar.value.split(" ")[0].split(this.calendar.sep),o=0,h=[];for(a=1;a<=s;a++){var u=new Date(t,e,a).getDay();if(0==u)h[o]=[];else if(1==a){h[o]=[];for(var c=i-n+1,l=0;l<n;l++)h[o].push({day:c,disabled:!0}),c++}var d=new Date,m=this,g=d.getFullYear(),f=d.getMonth(),y=(d.getDate(),{year:g,month:m.zero(d.getMonth()+1),day:m.zero(d.getDate())}),p={year:m.calendar.year,month:m.zero(m.calendar.month+1),day:m.zero(a)},_=dateCompare(p,y);if(parseInt(r[0])==this.calendar.year&&parseInt(r[1])-1==this.calendar.month&&parseInt(r[2])==a?(h[o].push({day:a,selected:!0}),this.calendar.today=[o,h[o].length-1]):g==this.calendar.year&&f==this.calendar.month&&a==this.calendar.day&&""==this.calendar.value?(h[o].push({day:a,selected:!0}),this.calendar.today=[o,h[o].length-1]):_?h[o].push({day:a,selected:!1}):h[o].push({day:a,disabled:!0}),6==u)o++;else if(a==s){var c=1;for(u;u<6;u++)h[o].push({day:c,disabled:!0}),c++}}this.calendar.days=h},prev:function(t){t.stopPropagation(),0==this.calendar.month?(this.calendar.month=11,this.calendar.year=parseInt(this.calendar.year)-1):this.calendar.month=parseInt(this.calendar.month)-1,this.calendar.monthString=this.calendar.months[this.calendar.month],this.render(this.calendar.year,this.calendar.month)},next:function(t){t.stopPropagation(),11==this.calendar.month?(this.calendar.month=0,this.calendar.year=parseInt(this.calendar.year)+1):this.calendar.month=parseInt(this.calendar.month)+1,this.calendar.monthString=this.calendar.months[this.calendar.month],this.render(this.calendar.year,this.calendar.month)},select:function(t,e,n){void 0!=n&&n.stopPropagation(),this.calendar.today.length>0&&this.calendar.days.forEach(function(t){t.forEach(function(t){t.selected=!1})}),this.calendar.days[t][e].selected=!0,this.calendar.day=this.calendar.days[t][e].day,this.calendar.today=[t,e],this.calendar.value=this.calendar.year+this.calendar.sep+this.zero(this.calendar.month+1)+this.calendar.sep+this.zero(this.calendar.days[t][e].day),this.calendar.show=!1},cancel:function(){this.calendar.show=!1},open:function(t){this.calendar.show=!0},onStart:function(){this.status.tipQuestion=!1},onNext:function(t,e){this.status[t]=!1,this.status[e]=!0},onPre:function(t,e){this.status[e]=!1,this.status[t]=!0},onSubmit1:function(){return(0!==this.Arr.subjectArr.length||""!==this.form.subject_other&&null!=this.form.subject_other)&&void this.onNext(this.question[0].key,this.question[1].key)},onSubmit2:function(){return 0!==this.Arr.aimArr.length&&void this.onNext(this.question[1].key,this.question[2].key)},onSubmit3:function(){return(this.time.Mon.length>0||this.time.Tue.length>0||this.time.Wed.length>0||this.time.Thr.length>0||this.time.Fri.length>0||1==this.form.sun_morning||1==this.form.sun_afternoon||1==this.form.sun_evening||1==this.form.sat_morning||1==this.form.sat_afternoon||1==this.form.sat_evening)&&void this.onNext(this.question[2].key,this.question[3].key)},onSubmit4:function(){return(null!=this.form.teacher_sex||0!==this.Arr.teacher_method_arr.length)&&void this.onNext(this.question[3].key,this.question[4].key)},onSubmit6:function(){return""!==this.form.require&&null!=this.form.require&&void this.onNext(this.question[5].key,this.question[6].key)},onSubmit7:function(){return this.form.salary!=Number&&void this.onNext(this.question[6].key,this.question[7].key)},onSelect:function(){switch(this.form.learning_phase){case 2:this.status.isSelected=!0,this.grade=this.learning_phase[1].value,this.form.grade="一年级";break;case 3:case 4:this.status.isSelected=!0,this.grade=this.learning_phase[2].value,this.form.grade="一年级";break;case 1:case 0:this.status.isSelected=!1}},onWeekday:function(t,e,n,s){var i=this.time,a=this.form;if(0==i[t].length&&(a[n]=e,a[s]=e),i[t].length>=1)if(e>a[s]){a[s]=e,i[t]=[];for(var r=a[n];r<a[s];r++)i[t].push(r)}else if(e>a[n]&&e<a[s]){a[s]=e,i[t]=[];for(var r=a[n];r<a[s];r++)i[t].push(r)}else if(e==a[n]){a[s]=a[n],i[t]=[];for(var r=a[n];r<=a[s];r++)i[t].push(r);a[n]="",a[s]=""}else if(e<a[n]&&a[n]<a[s]){a[n]=e,i[t]=[];for(var r=a[n]+1;r<=a[s];r++)i[t].push(r)}console.log(i[t])},clickPrice:function(){this.status.isPrice=!0},onClosePrice:function(){this.status.isPrice=!1},onStartLoaction:function(){return""==this.form.name?(this.status.textUsername="姓名不能为空",!1):""==this.form.tel?(this.status.textUsername="",this.status.textTip="手机号码不能为空",!1):/^1[34578]\d{9}$/.test(this.form.tel)?""==this.form.address?(this.status.textTip="",this.status.textAddress="地址不能为空",!1):(this.status.textAddress="",this.status.textUsername="",this.status.textTip="",this.getParam()?this.onSubmitQuestion("updateParentOrder"):this.onSubmitQuestion("createParentOrder"),void 0):(this.status.textTip="请填写正确的手机号码",!1)},onSubmitQuestion:function(t){var e=this;this.status.isSubmit=!0,this.$http.post(this.domain+t,this.form,{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(n){console.log(n.json()),this.status.isSubmit=!1,1==n.json().success?(e.status.errorTip="成功提交",e.status.getTip=!0,"createParentOrder"==t?(this.onAllow(),e.status.getTip=!1):(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.status.getTip=!1,location.href="./parentMyPage.html"},1e3))):(e.status.errorTip=n.json().error,e.status.getTip=!0,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.status.getTip=!1},2e3))})},onLocation:function(){this.$http.post(this.domain+"setLocations",this.location,{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){1==t.json().success&&(location.href="./parentPage.html")})},onAllow:function(){var t=this;wx.ready(function(){wx.getLocation({type:"wgs84",success:function(e){t.location.latitude=e.latitude,t.location.longitude=e.longitude,t.onLocation()}})})}}})}();