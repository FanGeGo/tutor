!function(){Vue.http.interceptors.push(function(t,i){t.credentials=!0,i()});new Vue({el:"body",data:{timer:null,domain:"http://www.yinzishao.cn",status:{isUser:!1,isDeal:!0,isOther:!1,isLoading:!1,isUploadImg:!1,isDeleteImg:!1,selected:""},config:{width:375,height:150,quality:.9},imgs:[],form:{image:"",url:""}},ready:function(){this.render(),this.status.isLoading=!0},methods:{render:function(){this.$http.post(this.domain+"/getText",{key:["getImg"]},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),1==t.json().success){for(var i=t.json().getImg,s=0;s<i.length;s++){var e=i[s].img;i[s].img=this.domain+e}this.$set("imgs",i)}else console.log(t.json().error)})},onUser:function(){window.location.href="./userAdministor.html"},onDeal:function(){window.location.href="./deal.html"},onOther:function(){window.location.href="./other.html"},onClose:function(){this.status.isUploadImg=!1},onClickImg:function(){return!(this.imgs.length>=5)&&void(this.status.isUploadImg=!0)},onSubmitImg:function(t){return""!==this.form.image&&void this.$http.post(this.domain+"/changeText",this.form,{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){console.log(t.json()),1==t.json().success&&(this.status.isUploadImg=!1,this.imgs.push({img:this.domain+t.json().image}),this.form.image="",this.form.url="")})},uploadPic:function(t){var i=this,s=t.target.files[0];lrz(s,i.config).then(function(t){i.form.image=t.base64}).catch(function(t){console.log(t),alert("压缩失败")}).always(function(){t.target.value=null})},remove:function(t){this.status.selected=t,this.status.isDeleteImg=!0},onSureDelete:function(t){var i=this,s=this.imgs[t].img.split(this.domain);this.$http.post(this.domain+"/deleteBanner",{image:s[1]},{emulateJSON:!0,headers:{"Content-Type":"application/json"}}).then(function(s){console.log(s.json()),1==s.json().success?(this.imgs.splice(t,1),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isDeleteImg=!1},300)):console.log(s.json().error)})},onCancel:function(){this.status.isDeleteImg=!1}}})}();