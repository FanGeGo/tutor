!function(){Vue.http.interceptors.push(function(t,s){t.credentials=!0,s()});new Vue({el:"body",data:{timer:null,domain:"http://www.yinzishao.cn/",status:{isParent:!0,isTeacher:!1,isSelecting:!0,isLoading:!1,isDeleteInfo:!1,selected:"",isList:!0,key:"家长",isNoList:!1},numData:{parentNum:0,teacherNum:0},form:{size:15,start:0,user:"parent",id:0,keyword:""},jsonData:[],mainData:[]},ready:function(){this.getNum(),location.search.indexOf("?")!=-1&&this.setOption(),"parent"==this.form.user?(this.status.isParent=!0,this.status.isTeacher=!1):(this.status.isParent=!1,this.status.isTeacher=!0),this.renderData(),this.status.isLoading=!0},methods:{down:function(){this.form.size=5,this.form.start++,0!==this.jsonData.length&&this.renderData()},getNum:function(){this.$http.get(this.domain+"getNum",{crossOrigin:!0}).then(function(t){1==t.json().success&&(this.numData.parentNum=t.json().parentNum,this.numData.teacherNum=t.json().teacherNum)})},setOption:function(){var t=location.search;if(t.indexOf("?")!=-1){t=t.substr(1,t.length).split("&");for(var s,i=0,e=t.length;i<e;i++)s=t[i].split("="),"user"==s[0]&&(this.form.user=s[1]),"keyword"==s[0]&&(this.form.keyword=decodeURIComponent(s[1]))}},renderData:function(){this.status.isSelecting=!0;var t;t="parent"==this.form.user?"getParentOrder":"getTeachers",this.$http.post(this.domain+t,{size:this.form.size,start:this.form.start,keyword:this.form.keyword},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),0==t.json().success)console.log(t.json().error);else{this.jsonData=t.json();var s=t.json();if(0!=s.length){this.status.isList=!0,this.status.isNoList=!1;var i=this.mainData.concat(s);this.$set("mainData",i),this.status.isSelecting=!1}else 0==this.mainData.length&&("parent"==this.form.user?this.status.key="家长":this.status.key="老师",this.status.isList=!1,this.status.isNoList=!0)}})},onUser:function(){this.status.deleteInfo=!1},onDeal:function(){window.location.href="./deal.html"},onOther:function(){window.location.href="./other.html"},onParent:function(){this.form.user="parent",this.form.start=0,this.form.size=15,this.status.isParent=!0,this.status.isTeacher=!1,this.mainData=[],this.renderData()},onTeacher:function(){this.form.user="teacher",this.form.start=0,this.form.size=15,this.status.isTeacher=!0,this.status.isParent=!1,this.mainData=[],this.renderData()},onSearch:function(){this.timer&&clearTimeout(this.timer),this.form.start=0,this.form.size=15,this.mainData=[],this.timer=setTimeout(this.renderData,200)},onDelete:function(t){this.status.selected=t,this.status.isDeleteInfo=!0,"parent"==this.form.user?this.form.id=this.mainData[t].pd_id:this.form.id=this.mainData[t].tea_id},onSureDelete:function(t){this.$http.post(this.domain+"deleteUser",{id:this.form.id,user:this.form.user},{crossOrigin:!0,headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(s){console.log(s.json()),1==s.json().success&&(this.status.isLoading=!0,this.status.isDeleteInfo=!1,this.mainData.splice(t,1))})},onCancel:function(){this.status.isDeleteInfo=!1},onDetailedInfo:function(t){"parent"==this.form.user?window.location.href="./detailedInfoParent.html?listId="+this.mainData[t].pd_id+"&keyword="+this.form.keyword:window.location.href="./detailedInfoTeacher.html?listId="+this.mainData[t].tea_id+"&keyword="+this.form.keyword}}})}();